{% extends "layout.html" %}

{% block title %}Roles - Vultrino{% endblock %}
{% block nav_roles %}active{% endblock %}
{% block page_title %}Roles{% endblock %}

{% block page_actions %}
<a href="/roles/new" class="btn btn-primary">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <line x1="12" y1="5" x2="12" y2="19"></line>
        <line x1="5" y1="12" x2="19" y2="12"></line>
    </svg>
    Create Role
</a>
{% endblock %}

{% block flash_message %}
{% if let Some(f) = flash %}
<div class="flash {{ f.kind.as_class() }}">
    {{ f.message }}
</div>
{% endif %}
{% endblock %}

{% block content %}
<div class="table-container">
    <table class="data-table">
        <thead>
            <tr>
                <th>Name</th>
                <th>Permissions</th>
                <th>Credential Scopes</th>
                <th>Created</th>
                <th></th>
            </tr>
        </thead>
        <tbody>
            {% for role in roles %}
            <tr>
                <td>
                    <div class="cell-primary">
                        {{ role.name }}
                        {% if role.is_builtin %}
                        <span class="badge badge-builtin">built-in</span>
                        {% endif %}
                    </div>
                    {% if !role.description.is_empty() %}
                    <div class="cell-secondary">{{ role.description }}</div>
                    {% endif %}
                </td>
                <td>
                    <div class="permission-badges">
                        {% for perm in role.permissions %}
                        <span class="badge badge-permission">{{ perm }}</span>
                        {% endfor %}
                    </div>
                </td>
                <td>
                    <code>{{ role.scopes }}</code>
                </td>
                <td>{{ role.created_at }}</td>
                <td class="cell-actions">
                    {% if !role.is_builtin %}
                    <form action="/roles/{{ role.id }}/delete" method="post" class="inline-form"
                          onsubmit="return confirm('Are you sure you want to delete this role?')">
                        <input type="hidden" name="csrf_token" value="{{ csrf_token }}">
                        <button type="submit" class="btn-icon btn-danger" title="Delete">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="3 6 5 6 21 6"></polyline>
                                <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                            </svg>
                        </button>
                    </form>
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
